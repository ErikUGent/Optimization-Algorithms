import numpy as np
import json

def jsonToData(file='Qurtinz.json', datasetName='Qurtinz_dataset'):
    with open(file, 'r') as f:
        datasetsdict = json.load(f)
    jsondata = datasetsdict[datasetName]
    
    return jsondata

data_j = jsonToData()

def create_data_model():
    data = {}
    data['distance_matrix'] = [
 [  0,  82,  47, 108, 136,   6,   4,  42,  54,  54,  57,  65,  75,  10,  5,  47,  12,  51,  88,  21,  83,  57,  60,  36,  55,  30,  20,  25,  62,  59,  72,  48,  59,   8,  90,  10,  59,   7,  49,  37,  47],
 [ 82,   0, 128, 184, 211,  81,  78,  63, 135,  27,  25, 140, 154,  79, 78,  39,  81, 133, 165,  66, 163, 132,  23, 117, 129,  71,  75, 101, 137, 133,  26, 129, 140,  76, 165,  85, 134,  80, 114, 104, 108],
 [ 47, 128,   0,  67,  93,  47,  50,  78,  12, 101, 103,  31,  33,  50, 50,  91,  48,  11,  47,  63,  39,  28, 106,  12,  30,  65,  59,  31, 29,  32, 118,   1,  16,  52,  51,  46,  29,  48,  43,  40,  48],
 [108, 184,  67,   0,  28, 105, 110, 123,  70, 157, 160,  44,  34, 107, 109, 145, 104,  71,  20, 118,  30,  52, 161,  78,  55, 114, 125,  84, 47,  51, 179,  66,  68, 111,  19, 110,  50, 107,  71,  80,  77],
 [136, 211,  93,  28,   0, 133, 138, 151,  95, 185, 188,  72,  61, 135, 137, 172, 132,  96,  47, 145,  55,  80, 188, 105,  83, 141, 152, 112, 75,  79, 207,  92,  92, 139,  47, 137,  78, 134,  98, 107, 104],
 [  6,  81,  47, 105, 133,   0,   5,  37,  55,  54,  57,  62,  73,   4,   4,  45,   5,  53,  86,  17,  82,  54,  59,  36,  51,  25,  25,  21, 59,  56,  74,  47,  60,   6,  87,  16,  56,   2,  44,  32,  42],
 [  4,  78,  50, 110, 138,   5,   0,  39,  57,  51,  53,  66,  77,   7,   2,  43,  10,  55,  90,  17,  86,  58,  56,  39,  56,  27,  20,  26, 63,  60,  69,  50,  62,   4,  92,  13,  60,   5,  49,  37,  47],
 [ 42,  63,  78, 123, 151,  37,  39,   0,  88,  41,  44,  81,  96,  33, 37,  25,  33,  87, 106,  22, 106,  73,  41,  70,  69,  13,  53,  47, 79,  73,  68,  79,  93,  35, 105,  51,  75,  36,  53,  45,  46],
 [ 54, 135,  12,  70,  95,  55,  57,  88,   0, 108, 110,  39,  37,  59, 57, 100,  57,   2,  50,  72,  40,  38, 113,  19,  41,  75,  63,  42, 38,  43, 123,  12,   5,  60,  57,  50,  40,  56,  55,  52,  60],
 [ 54,  27, 101, 157, 185,  54,  51,  41, 108,   0,   3, 114, 127,  51, 51,  16,  54, 106, 139,  40, 136, 105,   7,  90, 102,  45,  50,  74, 111, 106,  28, 102, 113,  48, 138,  58, 107,  53,  89,  78,  83],
 [ 57,  25, 103, 160, 188,  57,  53,  44, 110,   3,   0, 116, 129,  54, 53,  19,  57, 108, 141,  42, 138, 108,   8,  92, 105,  48,  51,  76, 113, 109,  25, 104, 115,  51, 141,  60, 110,  55,  92,  81,  86],
 [ 65, 140,  31,  44,  72,  62,  66,  81,  39, 114, 116,   0,  16,  63, 66, 101,  60,  39,  25,  74,  26,   8, 117,  39,  12,  71,  82,  41, 3,   9, 135,  30,  40,  67,  25,  68,   7,  63,  31,  37,  38],
 [ 75, 154,  33,  34,  61,  73,  77,  96,  37, 127, 129,  16,   0,  75, 77, 115,  72,  38,  14,  87,  10,  24, 130,  44,  28,  85,  91,  53, 18,  25, 147,  32,  36,  79,  20,  76,  23,  75,  47,  52,  54],
 [ 10,  79,  50, 107, 135,   4,   7,  33,  59,  51,  54,  63,  75,   0,  6,  41,   4,  57,  88,  13,  85,  55,  56,  40,  53,  20,  27,  23, 60,  57,  72,  51,  64,   5,  89,  20,  57,   3,  44,  32,  40],
 [  5,  78,  50, 109, 137,   4,   2,  37,  57,  51,  53,  66,  77,   6,  0,  43,   8,  55,  90,  16,  86,  58,  56,  39,  55,  25,  22,  25, 63,  59,  70,  51,  62,   3,  91,  14,  60,   3,  48,  36,  45],
 [ 47,  39,  91, 145, 172,  45,  43,  25, 100,  16,  19, 101, 115,  41, 43,   0,  44,  98, 126,  28, 124,  93,  16,  81,  89,  31,  48,  62, 98,  93,  43,  92, 105,  40, 126,  53,  95,  43,  75,  65,  69],
 [ 12,  81,  48, 104, 132,   5,  10,  33,  57,  54,  57,  60,  72,   4,  8,  44,   0,  55,  85,  15,  81,  52,  59,  38,  49,  20,  30,  19, 57,  53,  75,  48,  62,   8,  85,  21,  54,   5,  40,  28,  37],
 [ 51, 133,  11,  71,  96,  53,  55,  87,   2, 106, 108,  39,  38,  57, 55,  98,  55,   0,  51,  70,  42,  38, 111,  17,  41,  73,  61,  40, 38,  42, 121,  11,   7,  58,  57,  48,  39,  54,  54,  50,  59],
 [ 88, 165,  47,  20,  47,  86,  90, 106,  50, 139, 141,  25,  14,  88, 90, 126,  85,  51,   0,  99,  12,  34, 142,  58,  37,  96, 104,  65, 28,  34, 159,  46,  49,  92,   9,  90,  32,  87,  55,  62,  62],
 [ 21,  66,  63, 118, 145,  17,  17,  22,  72,  40,  42,  74,  87,  13, 16,  28,  15,  70,  99,   0,  96,  66,  43,  53,  63,  13,  31,  34, 71,  67,  63,  64,  77,  13,  99,  29,  68,  16,  51,  39,  46],
 [ 83, 163,  39,  30,  55,  82,  86, 106,  40, 136, 138,  26,  10,  85, 86, 124,  81,  42,  12,  96,   0,  34, 140,  51,  38,  95,  98,  62, 28,  35, 155,  38,  38,  88,  21,  84,  33,  83,  57,  62,  64],
 [ 57, 132,  28,  52,  80,  54,  58,  73,  38, 105, 108,   8,  24,  55, 58,  93,  52,  38,  34,  66,  34,   0, 109,  34,   5,  62,  75,  33, 5,   4, 127,  27,  40,  59,  33,  60,   2,  55,  24,  29,  30],
 [ 60,  23, 106, 161, 188,  59,  56,  41, 113,   7,   8, 117, 130,  56, 56,  16,  59, 111, 142,  43, 140, 109,   0,  95, 105,  47,  56,  78, 114, 109,  30, 106, 118,  53, 142,  64, 110,  57,  91,  81,  85],
 [ 36, 117,  12,  78, 105,  36,  39,  70,  19,  90,  92,  39,  44,  40, 39,  81,  38,  17,  58,  53,  51,  34,  95,   0,  35,  57,  48,  25, 36,  38, 106,  13,  24,  42,  62,  34,  36,  38,  43,  37,  46],
 [ 55, 129,  30,  55,  83,  51,  56,  69,  41, 102, 105,  12,  28,  53, 55,  89,  49,  41,  37,  63,  38,   5, 105,  35,   0,  59,  73,  30, 10,   4, 124,  30,  44,  57,  36,  59,   5,  53,  19,  25,  26],
 [ 30,  71,  65, 114, 141,  25,  27,  13,  75,  45,  48,  71,  85,  20, 25,  31,  20,  73,  96,  13,  95,  62,  47,  57,  59,   0,  44,  34, 68,  63,  71,  66,  80,  23,  95,  40,  64,  24,  44,  34,  38],
 [ 20,  75,  59, 125, 152,  25,  20,  53,  63,  50,  51,  82,  91,  27, 22,  48,  30,  61, 104,  31,  98,  75,  56,  48,  73,  44,   0,  44, 79,  77,  60,  61,  68,  23, 107,  14,  77,  25,  69,  57,  67],
 [ 25, 101,  31,  84, 112,  21,  26,  47,  42,  74,  76,  41,  53,  23, 25,  62,  19,  40,  65,  34,  62,  33,  78,  25,  30,  34,  44,   0, 38,  34,  95,  32,  47,  27,  66,  31,  35,  22,  26,  15,  26],
 [ 62, 137,  29,  47,  75,  59,  63,  79,  38, 111, 113,   3,  18,  60, 63,  98,  57,  38,  28,  71,  28,   5, 114,  36,  10,  68,  79,  38, 0,   7, 132,  28,  39,  64,  28,  65,   4,  60,  29,  34,  35],
 [ 59, 133,  32,  51,  79,  56,  60,  73,  43, 106, 109,   9,  25,  57, 59,  93,  53,  42,  34,  67,  35,   4, 109,  38,   4,  63,  77,  34, 7,   0, 129,  31,  44,  61,  32,  63,   3,  57,  22,  29,  29],
 [ 72,  26, 118, 179, 207,  74,  69,  68, 123,  28,  25, 135, 147,  72, 70,  43,  75, 121, 159,  63, 155, 127,  30, 106, 124,  71,  60,  95, 132, 129,   0, 119, 128,  68, 160,  72, 129,  72, 113, 102, 108],
 [ 48, 129,   1,  66,  92,  47,  50,  79,  12, 102, 104,  30,  32,  51, 51,  92,  48,  11,  46,  64,  38,  27, 106,  13,  30,  66,  61,  32, 28,  31, 119,   0,  16,  53,  51,  47,  29,  49,  43,  40,  48],
 [ 59, 140,  16,  68,  92,  60,  62,  93,   5, 113, 115,  40,  36,  64, 62, 105,  62,   7,  49,  77,  38,  40, 118,  24,  44,  80,  68,  47, 39,  44, 128,  16,   0,  65,  55,  55,  41,  61,  58,  56,  63],
 [  8,  76,  52, 111, 139,   6,   4,  35,  60,  48,  51,  67,  79,   5,  3,  40,   8,  58,  92,  13,  88,  59,  53,  42,  57,  23,  23,  27, 64,  61,  68,  53,  65,   0,  93,  17,  61,   4,  48,  37,  45],
 [ 90, 165,  51,  19,  47,  87,  92, 105,  57, 138, 141,  25,  20,  89, 91, 126,  85,  57,   9,  99,  21,  33, 142,  62,  36,  95, 107,  66, 28,  32, 160,  51,  55,  93,   0,  93,  31,  88,  52,  61,  59],
 [ 10,  85,  46, 110, 137,  16,  13,  51,  50,  58,  60,  68,  76,  20, 14,  53,  21,  48,  90,  29,  84,  60,  64,  34,  59,  40,  14,  31, 65,  63,  72,  47,  55,  17,  93,   0,  63,  17,  56,  45,  55],
 [ 59, 134,  29,  50,  78,  56,  60,  75,  40, 107, 110,   7,  23,  57, 60,  95,  54,  39,  32,  68,  33,   2, 110,  36,   5,  64,  77,  35, 4,   3, 129,  29,  41,  61,  31,  63,   0,  57,  24,  30,  31],
 [  7,  80,  48, 107, 134,   2,   5,  36,  56,  53,  55,  63,  75,   3,  3,  43,   5,  54,  87,  16,  83,  55,  57,  38,  53,  24,  25,  22, 60,  57,  72,  49,  61,   4,  88,  17,  57,   0,  45,  33,  42],
 [ 49, 114,  43,  71,  98,  44,  49,  53,  55,  89,  92,  31,  47,  44, 48,  75,  40,  54,  55,  51,  57,  24,  91,  43,  19,  44,  69,  26, 29,  22, 113,  43,  58,  48,  52,  56,  24,  45,   0,  12,   7],
 [ 37, 104,  40,  80, 107,  32,  37,  45,  52,  78,  81,  37,  52,  32, 36,  65,  28,  50,  62,  39,  62,  29,  81,  37,  25,  34,  57,  15, 34,  29, 102,  40,  56,  37,  61,  45,  30,  33,  12,   0,  11],
 [ 47, 108,  48,  77, 104,  42,  47,  46,  60,  83,  86,  38,  54,  40, 45,  69,  37,  59,  62,  46,  64,  30,  85,  46,  26,  38,  67,  26, 35,  29, 108,  48,  63,  45,  59,  55,  31,  42,   7,  11,   0]
   ] 

    data['demands'] = [x['Service'] for x in data_j]
    data['time_matrix'] = np.array(data['distance_matrix']) + data['demands']
    data['num_vehicles'] = 14
    data['num_nodes'] = len(data['demands'])
    data['depot'] = 0
    data['nodes'] = [x['name'] for x in data_j]

    data['vehicle_capacities'] = []
    for i in range(data['num_vehicles']):
        data['veh_cap'] = data['vehicle_capacities'].append(480)
    
    data['starts'] = [1, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0]
    data['ends'] = [1, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0]
    
    data['2_workers'] = []
    for Customer in data_j:
        if Customer['Workers']==2:
            data['2_w'] = data['2_workers'].append(Customer['name'])
    
    data['two_workers'] = []
    for node in data['2_workers']:
        data ['two_w'] = data['two_workers'].append(data['nodes'].index(node))
    
    print(data['demands'])
    print(data['num_nodes'])
    print(data['two_workers'])
    print(data['vehicle_capacities'])
    print(data['starts'])
    print(data['nodes'])
    return data
